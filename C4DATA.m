nodes = [0.603	18.356	0	0
1.605	18.667	0	0
1.591	19.886	0	0
3.622	20.035	0	0
4.259	20.333	0	0
4.99	20.008	0	0
4.611	18.518	0	0
4.002	19.155	0	0
3.297	18.464	0	0
3.947	17.624	0	0
1.781	16.284	0	0
2.065	15.702	0	0
2.959	14.943	0	0
5.708	15.512	0	0
6.073	16.216	0	0
5.708	16.704	0	0
6.236	17.029	0	0
5.423	18.153	0	0
6.222	18.071	0	0
6.669	18.87	0	0
6.534	20.671	0	0
8.321	20.428	0	0
8.592	19.642	0	0
9.242	19.588	0	0
9.973	19.913	0	0
9.913	19.114	0	0
10.238	18.83	0	0
11.741	18.505	0	0
13.223	19.845	0	0
14.584	18.119	0	0
13.569	17.266	0	0
12.898	16.067	0	0
12.269	15.62	0	0
11.964	14.523	0	0
11.334	14.828	0	0
11.456	15.559	0	0
10.928	16.209	0	0
10.258	17.652	0	0
10.197	18.423	0	0
8.856	18.159	0	0
8.572	18.87	0	0
7.678	18.606	0	0
6.988	16.169	0	0
7.373	15.458	0	0
6.541	14.828	0	0
7.231	13.813	0	0
6.236	11.009	0	0
4.733	10.989	0	0
4.083	11.659	0	0
3.331	12.919	0	0
2.763	14.463	0	0
2.194	14.341	0	0
2.681	12.614	0	0
2.844	11.416	0	0
2.031	10.888	0	0
2.844	10.4	0	0
4.205	9.75	0	0
5.22	9.323	0	0
6.398	9.527	0	0
7.028	9.811	0	0
7.089	10.359	0	0
8.613	10.4	0	0
9.364	11.903	0	0
10.502	12.228	0	0
9.405	9.689	0	0
9.059	8.836	0	0
9.263	8.145	0	0
8.531	8.552	0	0
7.333	9.039	0	0
6.663	8.755	0	0
6.053	8.714	0	0
5.809	8.064	0	0
5.078	8.125	0	0
4.814	7.475	0	0
5.545	7.475	0	0
6.114	7.008	0	0
6.439	7.902	0	0
7.922	7.292	0	0
7.597	6.195	0	0
7.475	5.586	0	0
6.744	5.342	0	0
6.134	5.911	0	0
5.83	5.505	0	0
6.216	4.509	0	0
6.114	3.738	0	0
7.577	2.803	0	0
8.227	2.397	0	0
8.592	2.945	0	0
7.983	3.514	0	0
7.252	3.9	0	0
8.003	4.57	0	0
9.263	4.53	0	0
9.628	5.302	0	0
10.278	5.139	0	0
9.506	3.778	0	0
9.019	2.641	0	0
10.116	1.808	0	0
10.725	1.97	0	0
10.441	3.128	0	0
11.213	3.27	0	0
12.025	2.803	0	0
11.761	1.93	0	0
12.797	0.975	0	0
14.259	2.092	0	0
14.341	3.494	0	0
13.325	3.778	0	0
13.711	5.017	0	0
14.97	4.469	0	0
15.844	3.27	0	0
15.438	2.173	0	0
15.763	1.584	0	0
14.97	0.569	0	0
16.798	0.305	0	0
16.555	1.625	0	0
17.022	2.234	0	0
17.631	3.148	0	0
16.771	4.394	0	0
17.448	5.098	0	0
16.907	5.721	0	0
15.959	5.83	0	0
15.228	6.723	0	0
14.09	6.317	0	0
13.196	5.64	0	0
12.736	6.128	0	0
11.761	5.911	0	0
11.355	6.615	0	0
10.786	6.696	0	0
9.648	7.482	0	0
10.271	8.348	0	0
11.111	9.242	0	0
12.248	9.134	0	0
14.469	8.998	0	0
15.878	9.567	0	0
14.794	10.326	0	0
14.036	10.163	0	0
12.98	10.894	0	0
14.469	11.328	0	0
14.198	12.167	0	0
14.578	12.953	0	0
15.526	13.278	0	0
16.094	14.009	0	0
17.015	13.738	0	0
16.826	14.659	0	0
16.636	16.501	0	0
17.313	16.88	0	0
17.855	16.582	0	0
18.694	17.557	0	0
18.044	18.071	0	0
18.071	18.83	0	0
16.988	19.263	0	0
16.663	20.184	0	0
15.553	20.184	0	0
15.39	19.073	0	0
15.228	17.665	0	0
14.848	16.663	0	0
15.038	15.363	0	0
14.09	15.038	0	0
13.819	14.523	0	0
13.521	14.009	0	0
13.061	13.332	0	0
12.438	12.411	0	0
11.538	12.573	0	0
11.456	13.772	0	0
10.502	13.894	0	0
10.563	14.767	0	0
9.831	15.6	0	0
8.145	15.194	0	0
7.556	14.767	0	0
7.942	14.178	0	0
9.628	13.975	0	0
1.158	16.798	0	0
0.609	15.925	0	0
1.32	14.544	0	0
0.792	13.163	0	0
3.453	8.572	0	0
2.945	6.459	0	0
3.92	6.094	0	0
4.205	5.159	0	0
5.112	5.058	0	0
9.784	0.765	0	0
10.976	4.692	0	0
11.741	11.05	0	0
15.823	4.773	0	0
16.798	2.864	0	0
12.695	7.516	0	0
13.833	7.008	0	0
13.528	9.648	0	0
13.366	11.964	0	0
15.986	17.773	0	0
16.819	18.423	0	0
17.489	17.956	0	0
12.898	17.591	0	0
13.223	18.302	0	0
9.852	4.713	0	0
14.909	1.93	0	0
18.2	1.219	0	0
12.716	14.259	0	0
5.363	14.97	0	0
6.994	3.419	0	0];

edgesdata = [1	2
2	3
3	4
4	5
5	6
6	7
7	8
8	9
9	10
10	11
11	12
12	13
13	14
14	15
15	16
16	17
17	18
18	19
19	20
20	21
21	22
22	23
23	24
24	25
25	26
26	27
27	28
28	29
29	30
30	31
31	32
32	33
33	34
34	35
35	36
36	37
37	38
38	39
39	40
40	41
41	42
42	43
43	44
44	45
45	46
46	47
47	48
48	49
49	50
50	51
51	52
52	53
53	54
54	55
54	56
56	57
57	58
58	59
59	60
60	61
61	62
62	63
63	64
64	65
65	66
66	67
67	68
68	69
69	70
70	71
71	72
72	73
73	74
74	75
75	76
76	77
77	78
78	79
79	80
80	81
81	82
82	83
83	84
84	85
85	199
86	87
87	88
88	89
89	91
90	91
91	92
92	93
93	94
94	194
194	95
95	96
96	97
97	98
98	99
99	100
100	101
101	102
102	103
103	104
104	105
105	106
106	107
107	108
108	109
109	110
110	111
111	112
112	113
113	114
114	115
115	116
116	117
117	118
118	119
119	120
120	121
121	122
122	123
123	124
124	125
125	126
126	127
127	128
128	129
129	130
130	131
131	132
132	133
133	134
134	135
135	136
136	137
137	138
138	139
139	140
140	141
141	142
142	143
143	144
144	145
145	146
146	147
147	148
148	149
149	150
150	151
151	152
152	153
153	154
154	155
155	156
156	157
157	158
158	159
159	160
160	161
161	162
162	163
163	164
164	165
165	166
166	167
167	168
168	169
169	170
170	164
2	9
1	3
1	171
171	172
171	11
172	11
12	52
173	52
174	52
174	172
175	56
174	55
54	49
53	50
57	48
73	58
7	18
7	10
10	16
40	166
37	166
38	40
17	43
15	43
20	42
24	26
27	39
14	45
46	198
46	169
44	167
170	167
46	63
64	170
47	61
58	71
59	70
60	69
70	77
72	77
72	75
74	175
74	177
175	176
74	83
177	178
178	179
179	83
76	79
80	91
84	81
84	90
86	199
90	199
86	89
92	95
95	99
79	93
67	78
67	128
78	128
94	127
62	65
65	130
130	182
182	64
64	162
182	136
161	136
161	188
136	188
160	188
138	188
136	131
94	181
100	181
125	181
98	102
97	180
101	106
107	123
122	107
96	88
93	194
126	185
185	131
131	186
185	186
124	186
186	122
121	132
105	108
111	113
109	184
184	115
184	116
109	117
113	196
115	196
104	195
110	195
112	195
108	183
120	183
183	117
132	135
135	187
134	137
139	159
140	158
141	156
144	155
154	189
144	189
189	190
153	150
31	157
32	157
31	155
192	28
192	31
192	193
33	36
197	158
197	34
197	160
34	163
23	41
4	8
150	190
190	191
148	191
145	191
165 35];

sinknodes = [1
2
4
5
6
21
22
25
29
152
151
150
149
148
147
146
142
140
137
134
133
121
120
119
118
116
115
196
113
112
103
180
87
178
176
55
174
]';


nodes(:,2) = -1*nodes(:,2);

edges = zeros(length(edgesdata),3);
for i = 1:length(edgesdata)
    edges(i,1:2) = edgesdata(i,1:2);
    edges(i,3) = distance(nodes(edges(i,1),1:3),nodes(edges(i,2),1:3));
end

edgesinit = edges;
nodesinit = nodes;
E = length(edges);
N = length(nodes);
Einit = length(edgesinit);
Ninit = length(nodesinit);

hold off
figure
for i = 1:length(edgesinit)
    plot([nodes(edgesinit(i,1),1) nodes(edgesinit(i,2),1)],[nodes(edgesinit(i,1),2) nodes(edgesinit(i,2),2)],'.-b')
    hold on
end

adjmatinit = genadjmat(edgesinit,Ninit);
degreevec = zeros(1,Ninit);
for i = 1:Ninit
    degreevec(i) = length(neighbours(i,adjmatinit));
end