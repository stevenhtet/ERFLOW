nodes = [1.503	7.719	0	0
3.013	7.482	0	0
3.826	7.509	0	0
5.559	6.751	0	0
6.046	6.94	0	0
5.451	7.834	0	0
6.805	6.507	0	0
6.927	5.911	0	0
7.631	5.776	0	0
8.47	6.114	0	0
8.734	6.581	0	0
8.958	7.638	0	0
9.608	8.47	0	0
9.801	9.13	0	0
10.42	8.958	0	0
10.678	10.651	0	0
11.368	10.867	0	0
11.517	11.707	0	0
12.167	11.111	0	0
13.041	10.055	0	0
14.138	9.445	0	0
14.584	9.689	0	0
15.295	9.913	0	0
16.311	9.141	0	0
16.88	9.648	0	0
19.778	7.726	0	0
19.859	6.832	0	0
19.29	6.696	0	0
19.764	5.708	0	0
19.297	5.606	0	0
19.046	5.085	0	0
18.694	6.534	0	0
18.302	6.317	0	0
17.543	6.114	0	0
17.868	4.936	0	0
18.518	5.058	0	0
19.216	13.203	0	0
12.235	11.747	0	0
7.597	8.592	0	0
16.595	6.195	0	0
17.083	4.746	0	0
15.702	6.019	0	0
14.578	6.967	0	0
14.74	8.443	0	0
14.212	8.768	0	0
13.061	8.538	0	0
12.228	7.902	0	0
11.761	6.588	0	0
12.303	5.735	0	0
11.598	5.234	0	0
11.598	4.503	0	0
9.676	5.274	0	0
13.873	6.141	0	0
14.266	5.18	0	0
15.201	5.139	0	0
16.108	4.069	0	0
13.481	4.421	0	0
14.903	4.476	0	0
14.239	3.433	0	0
15.485	2.634	0	0
16.23	2.837	0	0
16.243	3.555	0	0
16.907	2.241	0	0
16.609	1.564	0	0
15.444	1.754	0	0
14.699	1.916	0	0
14.483	1.442	0	0
13.968	1.659	0	0
14.442	0.914	0	0
13.67	0.982	0	0
12.668	2.201	0	0
11.896	2.417	0	0
11.449	3.257	0	0
12.533	3.433	0	0
13.115	3.094	0	0
13.806	3.704	0	0
13.873	2.526	0	0
12.513	1.341	0	0
11.497	1.584	0	0
11.233	1.117	0	0
10.522	1.117	0	0
9.405	2.641	0	0
8.572	4.591	0	0
8.988	5.109	0	0
8.768	5.572	0	0
9.459	6.453	0	0
6.845	5.491	0	0
7.333	5.207	0	0
6.805	4.801	0	0
5.911	5.87	0	0
5.18	5.762	0	0
5.139	4.909	0	0
5.627	4.543	0	0
4.638	4.706	0	0
3.88	4.922	0	0
3.663	5.599	0	0
4.191	6.087	0	0
4.029	6.791	0	0
2.038	6.574	0	0
1.198	6.175	0	0
0.345	7.556	0	0
0.63	5.566	0	0
0	6.155	0	0
1.808	5.098	0	0
3.473	4.489	0	0
1.28	4.814	0	0
0.894	4.002	0	0
-0.02	4.022	0	0
1.198	3.108	0	0
2.884	2.559	0	0
3.859	3.006	0	0
4.773	3.331	0	0
4.997	3.981	0	0
6.764	3.758	0	0
7.475	3.25	0	0
6.358	2.803	0	0
5.525	2.417	0	0
3.819	2.133	0	0
4.063	1.544	0	0
5.098	1.32	0	0
3.352	0.894	0	0
2.559	1.808	0	0
1.138	2.153	0	0
0.102	1.645	0	0
0.752	1.016	0	0
0.264	0.061	0	0
1.28	0.203	0	0
1.747	0.833	0	0
5.525	0.305	0	0
7.089	0.894	0	0
8.653	0.264	0	0
10.339	0.102	0	0
11.639	0.406	0	0
];

edgesdata = [1	2
2	3
3	4
4	5
5	6
5	7
7	8
8	9
9	10
10	11
11	12
12	13
13	14
14	15
15	16
16	17
17	18
18	19
19	20
20	21
21	22
22	23
23	24
24	25
25	26
26	27
27	28
28	29
29	30
30	31
28	32
32	33
33	34
34	35
33	36
30	33
31	36
35	36
34	40
40	41
24	40
25	37
40	42
42	43
43	44
44	45
45	46
46	47
47	48
48	49
49	50
50	51
51	52
52	84
52	86
11	86
85	86
10	85
85	84
84	83
83	82
82	81
81	80
80	79
79	78
78	71
71	72
72	73
73	74
74	75
75	76
76	59
59	77
75	77
71	77
66	77
68	77
68	70
68	67
67	66
66	65
65	60
59	60
60	61
61	62
62	56
56	41
56	58
55	58
55	42
43	53
53	54
54	55
54	57
57	58
57	76
49	53
51	74
61	63
63	64
64	65
67	69
72	79
71	77
80	133
81	132
129	130
130	131
130	120
120	129
106	107
107	108
108	109
109	110
110	111
111	112
112	113
113	114
114	115
115	116
116	117
117	112
117	120
118	119
119	120
119	121
121	122
122	123
123	124
124	125
125	126
125	127
127	128
122	128
121	128
109	123
102	103
104	106
102	106
100	102
99	100
100	101
100	104
99	96
98	97
97	96
96	95
95	94
94	92
92	93
92	91
91	90
4	90
91	97
4	98
3	98
2	96
104	105
95	105
105	111
94	113
93	113
93	89
90	87
87	8
87	88
88	9
88	89
87	89
89	114
89	83
12	39
9	85
13	15
15	47
20	46
17	19
19	38
123	125
122	110
110	118
111	118
116	82
82	73
107	109
114	116
41	35
21	45
22	44
];

sinknodes = [1
3
6
39
16
18
38
23
37
26
31
36
35
41
56
62
63
64
69
70
78
133
132
131
129
121
127
126
124
108
103
101]';


nodes(:,2) = -1*nodes(:,2);

edges = zeros(length(edgesdata),3);
for i = 1:length(edgesdata)
    edges(i,1:2) = edgesdata(i,1:2);
    edges(i,3) = distance(nodes(edges(i,1),1:3),nodes(edges(i,2),1:3));
end

edgesinit = edges;
nodesinit = nodes;
E = length(edges);
N = length(nodes);
Einit = length(edgesinit);
Ninit = length(nodesinit);

hold off
figure
for i = 1:length(edgesinit)
    plot([nodes(edgesinit(i,1),1) nodes(edgesinit(i,2),1)],[nodes(edgesinit(i,1),2) nodes(edgesinit(i,2),2)],'.-b')
    hold on
end

adjmatinit = genadjmat(edgesinit,Ninit);
degreevec = zeros(1,Ninit);
for i = 1:Ninit
    degreevec(i) = length(neighbours(i,adjmatinit));
end