nodes = [0.406	18.403	0	0
2.038	16.419	0	0
2.593	16.46	0	0
3.203	15.851	0	0
2.945	12.194	0	0
2.241	11.463	0	0
1.388	11.368	0	0
1.672	10.705	0	0
1.063	9.77	0	0
1.605	9.269	0	0
2.607	9.581	0	0
2.553	8.944	0	0
4.123	8.47	0	0
4.137	7.346	0	0
4.299	6.046	0	0
5.288	6.507	0	0
7.834	7.292	0	0
9.466	7.15	0	0
12.797	4.794	0	0
12.431	3.738	0	0
14.767	3.473	0	0
16.284	2.932	0	0
16.487	2.485	0	0
17.015	2.417	0	0
19.534	3.189	0	0
19.602	4.164	0	0
20.373	4.631	0	0
19.967	5.22	0	0
18.809	4.895	0	0
18.058	6.338	0	0
17.428	5.85	0	0
17.814	5.058	0	0
18.423	4.591	0	0
16.473	3.697	0	0
15.113	4.042	0	0
15.133	4.875	0	0
14.259	5.078	0	0
10.705	6.988	0	0
10.298	7.983	0	0
9.445	8.389	0	0
8.227	8.105	0	0
7.902	8.734	0	0
6.947	8.998	0	0
6.297	9.019	0	0
5.992	8.572	0	0
5.159	8.673	0	0
4.875	10.278	0	0
6.013	10.4	0	0
5.809	11.883	0	0
4.509	12.106	0	0
5.18	12.756	0	0
5.363	13.569	0	0
4.834	14.95	0	0
3.961	16.209	0	0
5.261	17.773	0	0
3.677	18.098	0	0
2.884	17.652	0	0
2.458	18.464	0	0
3.027	18.789	0	0
2.884	19.988	0	0
3.677	20.475	0	0
4.997	19.642	0	0
5.809	19.866	0	0
7.069	18.444	0	0
6.439	17.794	0	0
6.906	17.55	0	0
7.475	18.038	0	0
8.044	17.916	0	0
9.946	18.667	0	0
10.326	20.428	0	0
11.138	18.857	0	0
13.088	17.963	0	0
13.494	19.534	0	0
14.794	18.748	0	0
16.365	16.826	0	0
17.503	17.746	0	0
18.153	17.151	0	0
19.832	16.988	0	0
19.669	14.632	0	0
20.265	13.765	0	0
19.994	12.438	0	0
20.401	11.815	0	0
19.94	9.73	0	0
18.667	8.971	0	0
17.205	9.188	0	0
16.798	6.94	0	0
16.717	6.182	0	0
15.769	6.073	0	0
14.469	7.671	0	0
14.767	8.348	0	0
14.28	8.782	0	0
14.903	9.188	0	0
15.255	8.728	0	0
16.013	9.405	0	0
16.528	10.732	0	0
15.769	11.463	0	0
14.632	11.138	0	0
14.253	10.678	0	0
13.305	11.003	0	0
13.007	10.055	0	0
12.167	10.298	0	0
11.626	10.353	0	0
11.517	10.948	0	0
10.082	10.732	0	0
10.623	11.978	0	0
10.271	13.278	0	0
8.24	13.819	0	0
8.944	14.388	0	0
9.973	14.361	0	0
10.271	15.011	0	0
8.43	15.092	0	0
7.78	15.932	0	0
8.457	16.609	0	0
10.488	16.501	0	0
11.49	16.988	0	0
12.817	16.365	0	0
13.223	15.471	0	0
12.438	14.984	0	0
13.386	14.605	0	0
13.603	13.061	0	0
15.336	13.467	0	0
16.744	13.765	0	0
16.934	14.496	0	0
18.803	14.361	0	0
19.019	13.955	0	0
18.694	12.98	0	0
18.044	12.248	0	0
17.963	11.355	0	0
18.261	10.217	0	0
1.869	15.722	0	0
0.183	20.048	0	0
2.295	20.536	0	0
3.616	19.175	0	0
4.347	19.48	0	0
5.241	20.556	0	0
6.114	20.617	0	0
5.322	18.708	0	0
2.377	17.266	0	0
5.809	17.469	0	0
6.988	16.169	0	0
10.542	18.241	0	0
14.469	15.742	0	0
17.746	16.392	0	0
19.48	15.688	0	0
20.076	15.742	0	0
18.153	15.607	0	0
17.225	11.152	0	0
17.652	10.197	0	0
17.354	12.181	0	0
16.094	12.045	0	0
13.291	11.978	0	0
20.644	2.796	0	0
16.555	1.686	0	0
17.34	1.767	0	0
14.767	2.607	0	0
12.086	6.723	0	0
12.276	7.346	0	0
11.165	7.644	0	0
9.026	9.026	0	0
8.944	9.648	0	0
6.588	13.982	0	0
6.019	13.413	0	0
3.013	10.732	0	0
6.561	8.105	0	0
20.644	9.513	0	0
20.726	8.213	0	0
7.333	14.605	0	0
6.906	10.542	0	0];

edgesdata = [1	2
2	3
3	4
4	5
5	6
6	7
7	8
8	9
9	10
10	11
11	12
12	13
13	14
14	15
15	16
16	17
17	18
18	19
19	20
20	21
21	22
22	23
23	24
24	25
25	26
26	27
27	28
28	29
29	30
30	31
31	32
32	33
32	34
34	35
35	36
36	37
37	38
38	39
39	40
40	41
41	42
42	43
43	44
44	45
45	46
46	47
47	48
48	49
49	50
50	51
51	52
52	53
53	54
54	55
55	56
56	57
57	58
58	59
59	60
60	61
61	62
62	63
63	64
64	65
65	66
66	67
67	68
68	69
69	70
70	71
71	72
72	73
73	74
74	75
75	76
76	77
77	78
78	144
79	80
80	81
81	82
82	83
83	84
84	85
85	86
86	87
87	88
88	89
89	90
90	91
91	92
92	93
93	94
94	95
95	96
96	97
97	98
98	99
99	100
100	101
101	102
102	103
103	104
104	105
105	106
106	107
107	108
108	109
109	110
110	111
111	112
112	113
113	114
114	115
115	116
116	117
117	118
118	119
119	120
120	121
121	122
122	123
123	124
124	125
125	126
126	127
127	128
128	129
144	79
129	148
148	85
129	84
129	83
131	58
132	60
133	60
59	56
56	133
4	54
57	138
62	137
62	135
63	136
64	67
65	139
55	139
53	139
53	140
66	140
112	140
68	113
133	134
3	57
2	130
6	163
11	47
163	47
47	50
5	50
10	12
6	8
51	49
52	162
161	162
49	162
161	107
161	167
167	107
108	111
106	109
110	114
114	141
69	141
13	46
14	164
17	164
42	159
159	160
40	159
42	160
44	48
43	168
45	164
39	102
38	156
156	157
157	158
38	158
39	158
160	104
103	105
120	151
97	151
99	151
100	157
89	157
19	37
36	88
90	93
92	98
141	71
115	71
109	118
117	142
121	142
142	75
123	75
77	143
144	145
124	79
144	146
125	80
126	81
122	149
149	150
127	149
21	35
22	34
29	33
24	33
24	153
24	154
23	155
94	85
121	150
96	150
83	165
165	166
25	152
33	26
92	94
95	147
147	128
147	148
148	128
87 31
86 88
18 39];

sinknodes = [131
1
130
9
15
16
155
153
154
152
27
28
166
165
82
80
78
76
75
74
73
70
61
132]';


% nodes = nodes*2/121.111;
nodes(:,2) = -1*nodes(:,2);

edges = zeros(length(edgesdata),3);
for i = 1:length(edgesdata)
    edges(i,1:2) = edgesdata(i,1:2);
    edges(i,3) = distance(nodes(edges(i,1),1:3),nodes(edges(i,2),1:3));
end

edgesinit = edges;
nodesinit = nodes;
E = length(edges);
N = length(nodes);
Einit = length(edgesinit);
Ninit = length(nodesinit);

hold off
figure
for i = 1:length(edgesinit)
    plot([nodes(edgesinit(i,1),1) nodes(edgesinit(i,2),1)],[nodes(edgesinit(i,1),2) nodes(edgesinit(i,2),2)],'.-b')
%     plot3([nodes(edges(i,1),1) nodes(edges(i,2),1)],[nodes(edges(i,1),2) nodes(edges(i,2),2)],[nodes(edges(i,1),3) nodes(edges(i,2),3)],'db')
    hold on
end

% adjmat = genadjmat(edges,N);
adjmatinit = genadjmat(edgesinit,Ninit);
degreevec = zeros(1,Ninit);
for i = 1:Ninit
    degreevec(i) = length(neighbours(i,adjmatinit));
end